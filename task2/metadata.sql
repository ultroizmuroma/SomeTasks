/******************************************************************************/
/***         Generated by IBExpert 2017.1.10.1 01.08.2017 22:19:04          ***/
/******************************************************************************/

SET SQL DIALECT 3;

SET NAMES NONE;

SET CLIENTLIB 'D:\Work\Projects\RedSoft\reddb\wow64\fbclient.dll';

CREATE DATABASE 'D:\Work\SomeTasks\SomeTasks\task2\LIBRARY.FDB'
USER 'SYSDBA' PASSWORD 'masterkey'
PAGE_SIZE 16384
DEFAULT CHARACTER SET NONE COLLATION NONE;



/******************************************************************************/
/***                               Generators                               ***/
/******************************************************************************/

CREATE GENERATOR GEN_AUTHOR_BOOK_ID;
SET GENERATOR GEN_AUTHOR_BOOK_ID TO 111;

CREATE GENERATOR GEN_AUTHOR_ID;
SET GENERATOR GEN_AUTHOR_ID TO 15;

CREATE GENERATOR GEN_BOOK_ID;
SET GENERATOR GEN_BOOK_ID TO 23;



/******************************************************************************/
/***                                 Tables                                 ***/
/******************************************************************************/



CREATE TABLE AUTHOR (
    ID           INTEGER NOT NULL,
    FIRST_NAME   VARCHAR(255) NOT NULL,
    MIDDLE_NAME  VARCHAR(255) NOT NULL,
    LAST_NAME    VARCHAR(255)
);


CREATE TABLE AUTHOR_BOOK (
    ID         INTEGER NOT NULL,
    ID_AUTHOR  INTEGER NOT NULL,
    ID_BOOK    INTEGER NOT NULL
);


CREATE TABLE BOOK (
    ID     INTEGER NOT NULL,
    TITLE  VARCHAR(255)
);


INSERT INTO AUTHOR (ID, FIRST_NAME, MIDDLE_NAME, LAST_NAME) VALUES (3, 'Алексей', 'Евгеньевич', 'Баринов');
INSERT INTO AUTHOR (ID, FIRST_NAME, MIDDLE_NAME, LAST_NAME) VALUES (4, 'Алексей1', 'Евгеньевич1', 'Баринов1');
INSERT INTO AUTHOR (ID, FIRST_NAME, MIDDLE_NAME, LAST_NAME) VALUES (5, 'Алексей2', 'Евгеньевич2', 'Баринов2');
INSERT INTO AUTHOR (ID, FIRST_NAME, MIDDLE_NAME, LAST_NAME) VALUES (6, 'Алексей3', 'Евгеньевич3', 'Баринов3');
INSERT INTO AUTHOR (ID, FIRST_NAME, MIDDLE_NAME, LAST_NAME) VALUES (7, 'Алексей4', 'Евгеньевич4', 'Баринов4');
INSERT INTO AUTHOR (ID, FIRST_NAME, MIDDLE_NAME, LAST_NAME) VALUES (8, 'Алексей5', 'Евгеньевич5', 'Баринов5');
INSERT INTO AUTHOR (ID, FIRST_NAME, MIDDLE_NAME, LAST_NAME) VALUES (9, 'Алексей6', 'Евгеньевич6', 'Баринов6');
INSERT INTO AUTHOR (ID, FIRST_NAME, MIDDLE_NAME, LAST_NAME) VALUES (10, 'Алексей7', 'Евгеньевич7', 'Баринов7');
INSERT INTO AUTHOR (ID, FIRST_NAME, MIDDLE_NAME, LAST_NAME) VALUES (11, 'Алексей8', 'Евгеньевич8', 'Баринов8');
INSERT INTO AUTHOR (ID, FIRST_NAME, MIDDLE_NAME, LAST_NAME) VALUES (12, 'Алексей9', 'Евгеньевич9', 'Баринов9');
INSERT INTO AUTHOR (ID, FIRST_NAME, MIDDLE_NAME, LAST_NAME) VALUES (13, 'Алексей10', 'Евгеньевич10', 'Баринов10');
INSERT INTO AUTHOR (ID, FIRST_NAME, MIDDLE_NAME, LAST_NAME) VALUES (14, 'Алексей11', 'Евгеньевич11', 'Баринов11');
INSERT INTO AUTHOR (ID, FIRST_NAME, MIDDLE_NAME, LAST_NAME) VALUES (15, 'Алексей12', 'Евгеньевич12', 'Баринов12');

COMMIT WORK;

INSERT INTO BOOK (ID, TITLE) VALUES (1, 'Книга');
INSERT INTO BOOK (ID, TITLE) VALUES (2, 'Книга1');
INSERT INTO BOOK (ID, TITLE) VALUES (3, 'Книга2');
INSERT INTO BOOK (ID, TITLE) VALUES (4, 'Книга3');
INSERT INTO BOOK (ID, TITLE) VALUES (5, 'Книга4');
INSERT INTO BOOK (ID, TITLE) VALUES (6, 'Книга5');
INSERT INTO BOOK (ID, TITLE) VALUES (7, 'Книга6');
INSERT INTO BOOK (ID, TITLE) VALUES (8, 'Книга7');
INSERT INTO BOOK (ID, TITLE) VALUES (9, 'Книга8');
INSERT INTO BOOK (ID, TITLE) VALUES (10, 'Книга9');
INSERT INTO BOOK (ID, TITLE) VALUES (11, 'Книга10');
INSERT INTO BOOK (ID, TITLE) VALUES (12, 'Книга11');
INSERT INTO BOOK (ID, TITLE) VALUES (13, 'Книга12');
INSERT INTO BOOK (ID, TITLE) VALUES (14, 'Книга13');
INSERT INTO BOOK (ID, TITLE) VALUES (15, 'Книга14');
INSERT INTO BOOK (ID, TITLE) VALUES (16, 'Книга15');
INSERT INTO BOOK (ID, TITLE) VALUES (17, 'Книга16');
INSERT INTO BOOK (ID, TITLE) VALUES (18, 'Книга17');
INSERT INTO BOOK (ID, TITLE) VALUES (19, 'Книга18');
INSERT INTO BOOK (ID, TITLE) VALUES (21, 'Книга19');
INSERT INTO BOOK (ID, TITLE) VALUES (22, 'Книга20');
INSERT INTO BOOK (ID, TITLE) VALUES (23, 'Книга21');

COMMIT WORK;

INSERT INTO AUTHOR_BOOK (ID, ID_AUTHOR, ID_BOOK) VALUES (1, 3, 1);
INSERT INTO AUTHOR_BOOK (ID, ID_AUTHOR, ID_BOOK) VALUES (2, 3, 2);
INSERT INTO AUTHOR_BOOK (ID, ID_AUTHOR, ID_BOOK) VALUES (3, 3, 3);
INSERT INTO AUTHOR_BOOK (ID, ID_AUTHOR, ID_BOOK) VALUES (12, 7, 14);
INSERT INTO AUTHOR_BOOK (ID, ID_AUTHOR, ID_BOOK) VALUES (13, 9, 7);
INSERT INTO AUTHOR_BOOK (ID, ID_AUTHOR, ID_BOOK) VALUES (14, 9, 10);
INSERT INTO AUTHOR_BOOK (ID, ID_AUTHOR, ID_BOOK) VALUES (15, 4, 8);
INSERT INTO AUTHOR_BOOK (ID, ID_AUTHOR, ID_BOOK) VALUES (16, 13, 19);
INSERT INTO AUTHOR_BOOK (ID, ID_AUTHOR, ID_BOOK) VALUES (17, 9, 15);
INSERT INTO AUTHOR_BOOK (ID, ID_AUTHOR, ID_BOOK) VALUES (18, 13, 8);
INSERT INTO AUTHOR_BOOK (ID, ID_AUTHOR, ID_BOOK) VALUES (19, 11, 15);
INSERT INTO AUTHOR_BOOK (ID, ID_AUTHOR, ID_BOOK) VALUES (20, 15, 17);
INSERT INTO AUTHOR_BOOK (ID, ID_AUTHOR, ID_BOOK) VALUES (21, 9, 14);
INSERT INTO AUTHOR_BOOK (ID, ID_AUTHOR, ID_BOOK) VALUES (22, 11, 18);
INSERT INTO AUTHOR_BOOK (ID, ID_AUTHOR, ID_BOOK) VALUES (23, 6, 14);
INSERT INTO AUTHOR_BOOK (ID, ID_AUTHOR, ID_BOOK) VALUES (24, 6, 8);
INSERT INTO AUTHOR_BOOK (ID, ID_AUTHOR, ID_BOOK) VALUES (25, 10, 18);
INSERT INTO AUTHOR_BOOK (ID, ID_AUTHOR, ID_BOOK) VALUES (26, 15, 11);
INSERT INTO AUTHOR_BOOK (ID, ID_AUTHOR, ID_BOOK) VALUES (27, 12, 7);
INSERT INTO AUTHOR_BOOK (ID, ID_AUTHOR, ID_BOOK) VALUES (28, 14, 1);
INSERT INTO AUTHOR_BOOK (ID, ID_AUTHOR, ID_BOOK) VALUES (29, 13, 6);
INSERT INTO AUTHOR_BOOK (ID, ID_AUTHOR, ID_BOOK) VALUES (30, 10, 16);
INSERT INTO AUTHOR_BOOK (ID, ID_AUTHOR, ID_BOOK) VALUES (31, 10, 10);
INSERT INTO AUTHOR_BOOK (ID, ID_AUTHOR, ID_BOOK) VALUES (32, 5, 21);
INSERT INTO AUTHOR_BOOK (ID, ID_AUTHOR, ID_BOOK) VALUES (33, 14, 6);
INSERT INTO AUTHOR_BOOK (ID, ID_AUTHOR, ID_BOOK) VALUES (34, 13, 17);
INSERT INTO AUTHOR_BOOK (ID, ID_AUTHOR, ID_BOOK) VALUES (36, 13, 7);
INSERT INTO AUTHOR_BOOK (ID, ID_AUTHOR, ID_BOOK) VALUES (37, 10, 2);
INSERT INTO AUTHOR_BOOK (ID, ID_AUTHOR, ID_BOOK) VALUES (39, 10, 7);
INSERT INTO AUTHOR_BOOK (ID, ID_AUTHOR, ID_BOOK) VALUES (41, 14, 19);
INSERT INTO AUTHOR_BOOK (ID, ID_AUTHOR, ID_BOOK) VALUES (42, 5, 22);
INSERT INTO AUTHOR_BOOK (ID, ID_AUTHOR, ID_BOOK) VALUES (43, 10, 19);
INSERT INTO AUTHOR_BOOK (ID, ID_AUTHOR, ID_BOOK) VALUES (44, 14, 11);
INSERT INTO AUTHOR_BOOK (ID, ID_AUTHOR, ID_BOOK) VALUES (45, 6, 2);
INSERT INTO AUTHOR_BOOK (ID, ID_AUTHOR, ID_BOOK) VALUES (46, 13, 16);
INSERT INTO AUTHOR_BOOK (ID, ID_AUTHOR, ID_BOOK) VALUES (47, 9, 8);
INSERT INTO AUTHOR_BOOK (ID, ID_AUTHOR, ID_BOOK) VALUES (49, 13, 13);
INSERT INTO AUTHOR_BOOK (ID, ID_AUTHOR, ID_BOOK) VALUES (50, 15, 23);
INSERT INTO AUTHOR_BOOK (ID, ID_AUTHOR, ID_BOOK) VALUES (51, 11, 7);
INSERT INTO AUTHOR_BOOK (ID, ID_AUTHOR, ID_BOOK) VALUES (52, 8, 4);
INSERT INTO AUTHOR_BOOK (ID, ID_AUTHOR, ID_BOOK) VALUES (53, 4, 19);
INSERT INTO AUTHOR_BOOK (ID, ID_AUTHOR, ID_BOOK) VALUES (54, 9, 1);
INSERT INTO AUTHOR_BOOK (ID, ID_AUTHOR, ID_BOOK) VALUES (55, 11, 15);
INSERT INTO AUTHOR_BOOK (ID, ID_AUTHOR, ID_BOOK) VALUES (57, 5, 12);
INSERT INTO AUTHOR_BOOK (ID, ID_AUTHOR, ID_BOOK) VALUES (58, 14, 5);
INSERT INTO AUTHOR_BOOK (ID, ID_AUTHOR, ID_BOOK) VALUES (59, 8, 10);
INSERT INTO AUTHOR_BOOK (ID, ID_AUTHOR, ID_BOOK) VALUES (61, 7, 9);
INSERT INTO AUTHOR_BOOK (ID, ID_AUTHOR, ID_BOOK) VALUES (62, 5, 14);
INSERT INTO AUTHOR_BOOK (ID, ID_AUTHOR, ID_BOOK) VALUES (63, 12, 19);
INSERT INTO AUTHOR_BOOK (ID, ID_AUTHOR, ID_BOOK) VALUES (64, 8, 14);
INSERT INTO AUTHOR_BOOK (ID, ID_AUTHOR, ID_BOOK) VALUES (65, 5, 2);
INSERT INTO AUTHOR_BOOK (ID, ID_AUTHOR, ID_BOOK) VALUES (66, 13, 23);
INSERT INTO AUTHOR_BOOK (ID, ID_AUTHOR, ID_BOOK) VALUES (68, 12, 2);
INSERT INTO AUTHOR_BOOK (ID, ID_AUTHOR, ID_BOOK) VALUES (69, 4, 12);
INSERT INTO AUTHOR_BOOK (ID, ID_AUTHOR, ID_BOOK) VALUES (70, 14, 8);
INSERT INTO AUTHOR_BOOK (ID, ID_AUTHOR, ID_BOOK) VALUES (71, 6, 15);
INSERT INTO AUTHOR_BOOK (ID, ID_AUTHOR, ID_BOOK) VALUES (72, 6, 21);
INSERT INTO AUTHOR_BOOK (ID, ID_AUTHOR, ID_BOOK) VALUES (74, 4, 4);
INSERT INTO AUTHOR_BOOK (ID, ID_AUTHOR, ID_BOOK) VALUES (76, 14, 16);
INSERT INTO AUTHOR_BOOK (ID, ID_AUTHOR, ID_BOOK) VALUES (77, 9, 18);
INSERT INTO AUTHOR_BOOK (ID, ID_AUTHOR, ID_BOOK) VALUES (78, 4, 10);
INSERT INTO AUTHOR_BOOK (ID, ID_AUTHOR, ID_BOOK) VALUES (79, 7, 6);
INSERT INTO AUTHOR_BOOK (ID, ID_AUTHOR, ID_BOOK) VALUES (80, 11, 23);
INSERT INTO AUTHOR_BOOK (ID, ID_AUTHOR, ID_BOOK) VALUES (81, 6, 17);
INSERT INTO AUTHOR_BOOK (ID, ID_AUTHOR, ID_BOOK) VALUES (83, 9, 9);
INSERT INTO AUTHOR_BOOK (ID, ID_AUTHOR, ID_BOOK) VALUES (84, 15, 6);
INSERT INTO AUTHOR_BOOK (ID, ID_AUTHOR, ID_BOOK) VALUES (85, 15, 22);
INSERT INTO AUTHOR_BOOK (ID, ID_AUTHOR, ID_BOOK) VALUES (86, 13, 22);
INSERT INTO AUTHOR_BOOK (ID, ID_AUTHOR, ID_BOOK) VALUES (87, 4, 5);
INSERT INTO AUTHOR_BOOK (ID, ID_AUTHOR, ID_BOOK) VALUES (88, 8, 1);
INSERT INTO AUTHOR_BOOK (ID, ID_AUTHOR, ID_BOOK) VALUES (89, 11, 13);
INSERT INTO AUTHOR_BOOK (ID, ID_AUTHOR, ID_BOOK) VALUES (90, 8, 7);
INSERT INTO AUTHOR_BOOK (ID, ID_AUTHOR, ID_BOOK) VALUES (91, 15, 18);
INSERT INTO AUTHOR_BOOK (ID, ID_AUTHOR, ID_BOOK) VALUES (92, 14, 1);
INSERT INTO AUTHOR_BOOK (ID, ID_AUTHOR, ID_BOOK) VALUES (93, 11, 3);
INSERT INTO AUTHOR_BOOK (ID, ID_AUTHOR, ID_BOOK) VALUES (94, 8, 17);
INSERT INTO AUTHOR_BOOK (ID, ID_AUTHOR, ID_BOOK) VALUES (96, 5, 11);
INSERT INTO AUTHOR_BOOK (ID, ID_AUTHOR, ID_BOOK) VALUES (97, 12, 15);
INSERT INTO AUTHOR_BOOK (ID, ID_AUTHOR, ID_BOOK) VALUES (98, 8, 9);
INSERT INTO AUTHOR_BOOK (ID, ID_AUTHOR, ID_BOOK) VALUES (100, 12, 6);
INSERT INTO AUTHOR_BOOK (ID, ID_AUTHOR, ID_BOOK) VALUES (101, 6, 19);
INSERT INTO AUTHOR_BOOK (ID, ID_AUTHOR, ID_BOOK) VALUES (102, 15, 19);
INSERT INTO AUTHOR_BOOK (ID, ID_AUTHOR, ID_BOOK) VALUES (103, 7, 6);
INSERT INTO AUTHOR_BOOK (ID, ID_AUTHOR, ID_BOOK) VALUES (104, 13, 14);
INSERT INTO AUTHOR_BOOK (ID, ID_AUTHOR, ID_BOOK) VALUES (105, 6, 18);
INSERT INTO AUTHOR_BOOK (ID, ID_AUTHOR, ID_BOOK) VALUES (106, 11, 6);
INSERT INTO AUTHOR_BOOK (ID, ID_AUTHOR, ID_BOOK) VALUES (107, 11, 4);
INSERT INTO AUTHOR_BOOK (ID, ID_AUTHOR, ID_BOOK) VALUES (108, 10, 14);
INSERT INTO AUTHOR_BOOK (ID, ID_AUTHOR, ID_BOOK) VALUES (109, 12, 1);
INSERT INTO AUTHOR_BOOK (ID, ID_AUTHOR, ID_BOOK) VALUES (110, 6, 18);
INSERT INTO AUTHOR_BOOK (ID, ID_AUTHOR, ID_BOOK) VALUES (111, 8, 18);

COMMIT WORK;



/******************************************************************************/
/***                              Primary keys                              ***/
/******************************************************************************/

ALTER TABLE AUTHOR ADD CONSTRAINT PK_AUTHOR PRIMARY KEY (ID);
ALTER TABLE AUTHOR_BOOK ADD CONSTRAINT PK_AUTHOR_BOOK PRIMARY KEY (ID);
ALTER TABLE BOOK ADD CONSTRAINT PK_BOOK PRIMARY KEY (ID);


/******************************************************************************/
/***                              Foreign keys                              ***/
/******************************************************************************/

ALTER TABLE AUTHOR_BOOK ADD CONSTRAINT FK_AUTHOR_BOOK_1 FOREIGN KEY (ID_AUTHOR) REFERENCES AUTHOR (ID);
ALTER TABLE AUTHOR_BOOK ADD CONSTRAINT FK_AUTHOR_BOOK_2 FOREIGN KEY (ID_BOOK) REFERENCES BOOK (ID);


/******************************************************************************/
/***                                Triggers                                ***/
/******************************************************************************/



SET TERM ^ ;



/******************************************************************************/
/***                          Triggers for tables                           ***/
/******************************************************************************/



/* Trigger: AUTHOR_BI */
CREATE TRIGGER AUTHOR_BI FOR AUTHOR
ACTIVE BEFORE INSERT POSITION 0
AS
BEGIN
  IF (NEW.ID IS NULL) THEN
    NEW.ID = GEN_ID(GEN_AUTHOR_ID,1);
END
^


/* Trigger: AUTHOR_BOOK_BI */
CREATE TRIGGER AUTHOR_BOOK_BI FOR AUTHOR_BOOK
ACTIVE BEFORE INSERT POSITION 0
AS
BEGIN
  IF (NEW.ID IS NULL) THEN
    NEW.ID = GEN_ID(GEN_AUTHOR_BOOK_ID,1);
END
^


/* Trigger: BOOK_BI */
CREATE TRIGGER BOOK_BI FOR BOOK
ACTIVE BEFORE INSERT POSITION 0
AS
BEGIN
  IF (NEW.ID IS NULL) THEN
    NEW.ID = GEN_ID(GEN_BOOK_ID,1);
END
^

SET TERM ; ^